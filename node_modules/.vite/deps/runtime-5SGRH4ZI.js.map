{
  "version": 3,
  "sources": ["../../.deno/honox@0.1.39/node_modules/honox/dist/client/runtime.js"],
  "sourcesContent": ["import { Suspense, use } from \"hono/jsx/dom\";\nimport { COMPONENT_NAME, DATA_HONO_TEMPLATE, DATA_SERIALIZED_PROPS } from \"../constants.js\";\nconst buildCreateChildrenFn = (createElement, importComponent) => {\n  let keyIndex = 0;\n  const setChildrenFromTemplate = async (props, element) => {\n    const maybeTemplate = element.childNodes[element.childNodes.length - 1];\n    if (maybeTemplate?.nodeName === \"TEMPLATE\" && maybeTemplate?.getAttribute(DATA_HONO_TEMPLATE) !== null) {\n      props.children = await createChildren(\n        maybeTemplate.content.childNodes\n      );\n    }\n  };\n  const createElementFromHTMLElement = async (element) => {\n    const props = {\n      children: await createChildren(element.childNodes)\n    };\n    const attributes = element.attributes;\n    for (let i = 0; i < attributes.length; i++) {\n      props[attributes[i].name] = attributes[i].value;\n    }\n    return createElement(element.nodeName, {\n      key: ++keyIndex,\n      ...props\n    });\n  };\n  const createChildren = async (childNodes) => {\n    const children = [];\n    for (let i = 0; i < childNodes.length; i++) {\n      const child = childNodes[i];\n      if (child.nodeType === 8) {\n        continue;\n      } else if (child.nodeType === 3) {\n        children.push(child.textContent);\n      } else if (child.nodeName === \"TEMPLATE\" && child.id.match(/(?:H|E):\\d+/)) {\n        const placeholderElement = document.createElement(\"hono-placeholder\");\n        placeholderElement.style.display = \"none\";\n        let resolve;\n        const promise = new Promise((r) => resolve = r);\n        child.replaceWith = (node) => {\n          createChildren(node.childNodes).then(resolve);\n          placeholderElement.remove();\n        };\n        let fallback = [];\n        for (\n          // equivalent to i++\n          placeholderElement.appendChild(child);\n          i < childNodes.length;\n          i++\n        ) {\n          const child2 = childNodes[i];\n          if (child2.nodeType === 8) {\n            placeholderElement.appendChild(child2);\n            i--;\n            break;\n          } else if (child2.nodeType === 3) {\n            fallback.push(child2.textContent);\n          } else {\n            fallback.push(await createElementFromHTMLElement(child2));\n          }\n        }\n        const fallbackTemplates = document.querySelectorAll(\n          `[data-hono-target=\"${child.id}\"]`\n        );\n        if (fallbackTemplates.length > 0) {\n          const fallbackTemplate = fallbackTemplates[fallbackTemplates.length - 1];\n          fallback = await createChildren(fallbackTemplate.content.childNodes);\n        }\n        if (fallback.length === 0 && child.id.startsWith(\"E:\")) {\n          let resolve2;\n          const promise2 = new Promise((r) => resolve2 = r);\n          fallback = await createElement(Suspense, {\n            fallback: [],\n            children: [await createElement(() => use(promise2), {})]\n          });\n          placeholderElement.insertBefore = (node) => {\n            createChildren(node.childNodes).then(resolve2);\n          };\n        }\n        document.body.appendChild(placeholderElement);\n        children.push(\n          await createElement(Suspense, {\n            fallback,\n            children: [await createElement(() => use(promise), {})]\n          })\n        );\n      } else {\n        let component = void 0;\n        const componentName = child.getAttribute(COMPONENT_NAME);\n        if (componentName) {\n          component = await importComponent(componentName);\n        }\n        if (component) {\n          const props = JSON.parse(child.getAttribute(DATA_SERIALIZED_PROPS) || \"{}\");\n          await setChildrenFromTemplate(props, child);\n          children.push(\n            await createElement(component, {\n              key: ++keyIndex,\n              ...props\n            })\n          );\n        } else {\n          children.push(await createElementFromHTMLElement(child));\n        }\n      }\n    }\n    return children;\n  };\n  return createChildren;\n};\nconst hydrateComponentHonoSuspense = async (hydrateComponent) => {\n  const templates = /* @__PURE__ */ new Set();\n  const observerTargets = /* @__PURE__ */ new Set();\n  document.querySelectorAll('template[id^=\"H:\"], template[id^=\"E:\"]').forEach((template) => {\n    if (template.parentElement) {\n      templates.add(template);\n      observerTargets.add(template.parentElement);\n    }\n  });\n  if (observerTargets.size === 0) {\n    return;\n  }\n  const observer = new MutationObserver((mutations) => {\n    const targets = /* @__PURE__ */ new Set();\n    mutations.forEach((mutation) => {\n      if (mutation.target instanceof Element) {\n        targets.add(mutation.target);\n        mutation.removedNodes.forEach((node) => {\n          templates.delete(node);\n        });\n      }\n    });\n    targets.forEach((target) => {\n      hydrateComponent(target);\n    });\n    if (templates.size === 0) {\n      observer.disconnect();\n    }\n  });\n  observerTargets.forEach((target) => {\n    observer.observe(target, { childList: true });\n  });\n};\nexport {\n  buildCreateChildrenFn,\n  hydrateComponentHonoSuspense\n};\n"],
  "mappings": "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",
  "names": []
}
